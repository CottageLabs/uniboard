{% extends "base.html" %}

{% block content %}
{% from "_formhelpers.html" import render_field %}

{% if current_user.id == account.id or current_user.is_super %}

    {% if current_user.id != account.id %}
        <div class="alert alert-danger"><strong>NOTE</strong> you are editing a user account that is not your own.  Be careful!</div>
    {% endif %}

    <div class="row-fluid" style="padding-bottom: 10px; margin-bottom: 30px; padding-left: 30px; border-bottom: 3px dashed #aaaaaa">
        <div class="span12"><h1>{{ account.id }}</h1></div>
    </div>


    <div class="row-fluid">

        <div class="span6">
            <div style="border: 1px solid #cccccc; padding: 10px; margin: 10px">
                <h4 style="padding-bottom: 10px">Update your details</h4>
                <form id="updateform" method="post" action="{{url_for('account.username', username=account.id)}}">
                <div class="form-horizontal wide">
                    {{ render_field(form.name, style="width: 90%", placeholder="your name") }}
                    {{ render_field(form.degree, class="input-large") }}
                    {{ render_field(form.postcode, style="width: 100px", placeholder="home post code") }}
                    {{ render_field(form.phone, style="width: 200px", placeholder="your telephone number") }}
                    {{ render_field(form.graduation, style="width: 100px", placeholder="e.g. 2016") }}
                    <input type="submit" class="btn btn-success" name="submit" value="Update">
                </div>
                </form>
            </div>
        </div>
        
        <div class="span6">
            <div style="border: 1px solid #cccccc; padding: 10px; margin: 10px">
                <h4 style="padding-bottom: 10px">Change your password</h4>
                <form action="" method="POST">
                    <div class="form-horizontal wide">
                    {{ render_field(pwform.old_password, style="width: 90%", placeholder="current password") }}
                    {{ render_field(pwform.password, style="width: 90%", placeholder="new password") }}
                    {{ render_field(pwform.confirm_password, style="width: 90%", placeholder="confirm your new password") }}
                    <input type="submit" class="btn btn-success" name="submit" value="Update">
                    </div>
                </form>
            </div>
            
            {% if current_user.is_super %}
            <div style="border: 1px solid #cccccc; padding: 10px; margin: 10px">
                <h4>Delete this account</h4>
                <p>(This <strong>irrevocably</strong> deletes the account)</p>
                <form action="" method="POST">
                    <input type="submit" name="submit" value="Delete" class="btn btn-danger">
                    <input type="radio" name="confirm" value="confirm">&nbsp;yes, I'm sure
                </form>
            </div>
            {% endif %}
        </div>

    </div>

{% for ad in adverts %}
    {% if ad.is_deleted==False %}
    <div class="row-fluid">
        <div class="span12" style="border: 1px solid #cccccc; padding: 10px; margin: 10px">
            <div class="row-fluid">
                <div class="span6">
                    <p></p><a href="{{url_for('advert.details', ad_id=ad.id)}}">{{ ad.title }}</a></p>
                </div>
                <div class="span3">
                    <a href="{{url_for('advert.adsubmit', ad_id=ad.id)}}" class="btn btn-large">Edit</a>
                    <a href="{{url_for('advert.delete', ad_id=ad.id)}}" class="btn btn-large" id="delete">Delete</a>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
{% endfor %}
    
{% else %}

    <div class="row-fluid">
        <div class="span6">
            <div class="hero-unit">
                <h2>{{ account.id }}</h2>
            </div>
        </div>
        <div class="span6">
            <p>You are not logged in as this user. Use the <a href="/account/login">login page</a> if you want to change this</p>
        </div>
    </div>
    
{% endif %}

{% endblock %}

{% block extra_js_bottom %}
{{super()}}
<script type="text/javascript" src="/static/uniboard/js/confirm.js"></script>
<script type="text/javascript" src="/static/uniboard/js/register.js"></script>
{% endblock extra_js_bottom %}

